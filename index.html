<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Werde Aktiv</title>
    <link href="styles_index.css" rel="stylesheet" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@200..700&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Burger-Menü Button -->
    <div class="burger-menu" onclick="toggleMenu()">
        <div></div>
        <div></div>
        <div></div>
    </div>

    <!-- Navigations-Menü -->
    <div class="menu" id="menu">
        <a href="index.html">START</a>
        <a href="werd_aktiv.html">WERDE AKTIV</a>
        <a href="resources.html">RECOURCEN</a>
        <a href="uber_uns.html">ÜBER UNS</a>
    </div>

     <a id="WerdeJetztAktiv" href="werd_aktiv.html">
            <h1>BLEIB NICHT<br>
            ZUSCHAUER*IN<br></h1>
            <h1 style="text-decoration: underline; margin-top: 2vh;">WERD<br>AKTIV!</h1>
    </a>

         <div id="ÜberallKriesen">
            <h1>ÜBERALL<br>
            KRIESEN
        </h1>
    </div>


    <!-- Stop-Motion Animation -->
    <div id="animation-container">
        <img id="stopMotion" src="images/erde_brennt1" alt="Stop Motion">
        <img id="earth" src="images/erde.png" alt="erde">
    </div>

    <div id="scrollDown">
        <img src="images/arrow-down.svg" width="50" height="50">
    </div>

    <script>
        // --------------------------
        // BURGER-MENÜ EIN-/AUSBLENDEN
        // --------------------------
        const burger = document.querySelector('.burger-menu');
        let lastScrollY = window.pageYOffset;

        window.addEventListener('scroll', () => {
            const currentY = window.pageYOffset;
            const delta = currentY - lastScrollY;

            if (delta > 4) {
                burger.classList.add('hidden'); // Scroll nach unten -> verstecken
            } else if (delta < -4) {
                burger.classList.remove('hidden'); // Scroll nach oben -> zeigen
            }

            lastScrollY = currentY <= 0 ? 0 : currentY;
        }, { passive: true });


        // --------------------------
        // STOP-MOTION ANIMATION
        // --------------------------

        if(window.matchMedia("(max-width: 1.080px)").matches) {
            // Lade mobiles Bild
            document.getElementById("bild1").src = "images/erde_brennt1_small.png";
            document.getElementById("bild2").src = "images/erde_brennt2_small.png";
            document.getElementById("bild3").src = "images/erde_brennt3_small.png";
        } else {
            // Lade Desktop-Bild
            document.getElementById("bild1").src = "images/erde_brennt1.png";
            document.getElementById("bild2").src = "images/erde_brennt2.png";
            document.getElementById("bild3").src = "images/erde_brennt3.png";
        }

        const frames = [
            bild1,
            bild2,
            bild3,
            bild2
        ];
        let index = 0;
        const imgElement = document.getElementById("stopMotion");

        function playAnimation() {
            index = (index + 1) % frames.length;
            imgElement.src = frames[index];
        }
        setInterval(playAnimation, 300); //ms


        // --------------------------
        // BURGER-MENÜ TOGGLE
        // --------------------------
        function toggleMenu() {
            document.getElementById("menu").classList.toggle("active");
        }


        // --------------------------
        // KÜNSTLICHE INERTIA (funktioniert ohne echten Scroll!)
        // --------------------------

        let scale = 1;
        const el = document.querySelector("#stopMotion");
        const firstText = document.querySelector("#ÜberallKriesen");
        const secondText = document.querySelector("#WerdeJetztAktiv");


        let velocity = 0;
        let inertiaFrame = null;
        let lastTouchY = 0;

        function applyFade(delta) {
            scale += delta * -0.003;
            scale = Math.min(Math.max(0, scale), 1);

            el.style.opacity = scale;
            
            firstText.style.opacity = scale;
            secondText.style.opacity = 1 - scale;
        }

        // Inertia Loop
        function inertiaStep() {
            if (Math.abs(velocity) < 0.1) {
                velocity = 0;
                inertiaFrame = null;
                return;
            }

            applyFade(velocity);

            // iOS-like slowdown
            velocity *= 0.92;

            inertiaFrame = requestAnimationFrame(inertiaStep);
        }


        // TOUCH -------------------------

        window.addEventListener("touchstart", e => {
            lastTouchY = e.touches[0].clientY;

            if (inertiaFrame) cancelAnimationFrame(inertiaFrame);
            inertiaFrame = null;
        }, { passive: true });

        window.addEventListener("touchmove", e => {
            const y = e.touches[0].clientY;
            const delta = lastTouchY - y;
            lastTouchY = y;

            velocity = delta;
            applyFade(delta);
        }, { passive: true });

        window.addEventListener("touchend", () => {
            if (Math.abs(velocity) > 0.5) {
                inertiaFrame = requestAnimationFrame(inertiaStep);
            }
        }, { passive: true });


        // DESKTOP WHEEL ------------------

        window.addEventListener("wheel", e => {
            velocity = e.deltaY;
            applyFade(e.deltaY);

            if (inertiaFrame) cancelAnimationFrame(inertiaFrame);
            inertiaFrame = requestAnimationFrame(inertiaStep);
        }, { passive: true });


    </script>
</body>
</html>
